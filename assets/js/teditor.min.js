function skytake_exit_confirm(e){return!(Object.keys(e).length&&!confirm("The changes you made will be lost if you navigate away from this page."))}function skytake_set_mailchimp_lists(){teditor.ajax("get_mailchimp_list_items",{api_key:teditor.getValue("mailchimp_apikey")}).done(function(e){if(!e.success)return!1;var t=e.data.lists,i=teditor.getElement("mailchimp_listid"),n=i.parent().find(".__list");i.html(""),n.html(""),Object.keys(t).map(function(e){i.append('<option value="'+e+'">'+t[e]+"</option>"),n.append('<div data-value="'+e+'">'+t[e]+"</div>")}),i.val(e.data.selected).trigger("change"),teditor.save_el.attr("disabled","disabled")})}function skytake_change_template(e){teditor.loader_el.show(),teditor.body_el.find("#skytake_editor").attr("data-template",e);var t=teditor.preview.html.find("#skytake_front_skin-css"),i=teditor_params.skins_url+e+"/css/skin.min.css";teditor.ajax("get_preview_template_markup",{skin:e}).done(function(n){if(!n.success)return!1;t.attr("href",i),teditor.preview.html.find("#skytake_front_skin-inline-css").remove(),teditor.preview.el.replaceWith(n.data.markup.campaign_markup),teditor.preview.el=teditor.preview.html.find(".skytake"),teditor.preview.el.attr("data-template",e),Object.keys(n.data.settings).map(function(e){var t=teditor.getElement(e);if(void 0===t)return null;if("object"!=typeof n.data.settings[e])teditor.setValue(e,n.data.settings[e]);else{if(n.data.settings[e].hasOwnProperty("value")&&teditor.setValue(e,n.data.settings[e].value),n.data.settings[e].hasOwnProperty("class")){var i=t.closest(".skt__setting");null==i.data("class")&&i.attr("data-class",i.attr("class")),i.attr("class",i.data("class")+" "+n.data.settings[e].class)}n.data.settings[e].hasOwnProperty("title")&&t.closest(".skt__setting").find(".dlb_input_title").text(n.data.settings[e].title),n.data.settings[e].hasOwnProperty("description")&&t.closest(".skt__setting").find(".dlb_input_description").text(n.data.settings[e].description)}t.closest(".dlb_input_colorpicker").length&&t.trigger("change")}),teditor.preview.controller.off(),delete teditor.preview.controller,setTimeout(function(){teditor.preview.controller=new TController(teditor.preview.html),teditor.loader_el.hide()},200)})}function skytake_change_font(e){var t=teditor.preview.html.find("#skytake_front_fonts-css");if(t.length||(teditor.preview.html.find("body").prepend('<link rel="stylesheet" id="skytake_front_fonts-css" type="text/css" media="all" href="https://fonts.googleapis.com/css?family=&display=swap">'),t=teditor.preview.html.find("#skytake_front_fonts-css")),"theme_font"!==e){var i=t.attr("href").replace(new RegExp("family=.*?&","gm"),"family="+teditor_params.fonts[e][0]+"&");t.attr("href",i),setTimeout(function(){teditor.preview.el.css("font-family",teditor_params.fonts[e][1])},100)}else teditor.preview.el.css("font-family","initial")}function skytake_urgency_control(e){var t=jQuery(".skytake_urgency_session_container"),i=jQuery(".skytake_urgency_session_recreate_container"),n=jQuery(".urgency_expire_date_container"),a=jQuery(".urgency_usage_limit_container");"disabled"===e?(t.addClass("__hidden"),i.addClass("__hidden"),n.addClass("__hidden"),a.addClass("__hidden")):"session"===e?(t.removeClass("__hidden"),i.removeClass("__hidden"),n.addClass("__hidden"),a.addClass("__hidden")):"expiry_date"===e?(t.addClass("__hidden"),i.addClass("__hidden"),n.removeClass("__hidden"),a.addClass("__hidden")):"usage_limit"===e&&(t.addClass("__hidden"),i.addClass("__hidden"),n.addClass("__hidden"),a.removeClass("__hidden"))}function skytake_campaign_name_control(e){jQuery("#skt_editor_bar > header .skt__name").text(e)}function skytake_input_name_control(e){var t=jQuery(this),i=teditor.preview.el.find(".skytake-form-more");1==e?(t.closest("li").next().removeClass("__hidden"),teditor.preview.el.find(".skytake-name").addClass("__show"),i.attr("data-count",parseInt(i.attr("data-count"))+1)):(t.closest("li").next().addClass("__hidden"),teditor.preview.el.find(".skytake-name").removeClass("__show"),i.attr("data-count",parseInt(i.attr("data-count"))-1))}function skytake_input_mobile_control(e){var t=jQuery(this),i=teditor.preview.el.find(".skytake-form-more");1==e?(t.closest("li").next().removeClass("__hidden"),teditor.preview.el.find(".skytake-mobile").addClass("__show"),i.attr("data-count",parseInt(i.attr("data-count"))+1)):(t.closest("li").next().addClass("__hidden"),teditor.preview.el.find(".skytake-mobile").removeClass("__show"),i.attr("data-count",parseInt(i.attr("data-count"))-1))}function skytake_bg_image_control(e){""==e?(teditor.preview.el.attr("data-background",0),teditor.preview.el.find(".skytake-container").css("background-image","none")):(teditor.preview.el.attr("data-background",1),teditor.preview.el.find(".skytake-container").css("background-image","url("+e+")"))}var TEditor=function(){this.campaign_type=jQuery('input[name="skytake_campaign_type"]').val(),this.body_el=jQuery("body"),this.win_el=jQuery(window),this.loader_el=jQuery("#skytake_loader"),this.panel_el=jQuery("#skt_editor_panel"),this.lvl2_el=this.panel_el.find(".skt__level_2"),this.lvl2_title_el=this.panel_el.find(".skt__level_2_title"),this.back_el=this.lvl2_title_el.find(".__arrow"),this.bar_el=jQuery("#skt_editor_bar"),this.save_el=this.bar_el.find(".skt__btn_save"),this.exit_el=this.bar_el.find(".skt__btn_exit"),this.iframe_el=jQuery("#skytake_editor_iframe iframe"),this.preview={},this.changed_settings={},this.listener_list={},this.init()};TEditor.prototype.init=function(){var e=this;this.iframe_el.on("load",function(t){var i=e.iframe_el[0];e.preview.window=i.contentWindow?i.contentWindow:i.contentDocument.defaultView,e.preview.document=i.contentDocument||e.iframe_window_el.document,e.loader_el.hide(),jQuery(e.preview.document).ready(function(){e.preview.html=e.iframe_el.contents(),"popup"===teditor_params.campaign_type?(e.preview.el=e.preview.html.find(".skytake-popup"),e.preview.bar=e.preview.html.find(".skytake-bar")):"floating-bar"===teditor_params.campaign_type?(e.preview.el=e.preview.html.find(".skytake-floating-bar"),e.preview.bar=e.preview.html.find(".skytake-bar")):"scroll-box"===teditor_params.campaign_type?(e.preview.el=e.preview.html.find(".skytake-scroll-box"),e.preview.bar=e.preview.html.find(".skytake-bar")):"content-form"===teditor_params.campaign_type?e.preview.el=e.preview.html.find(".skytake-content-form"):"widget-form"===teditor_params.campaign_type&&(e.preview.el=e.preview.html.find(".skytake-widget-form")),e.preview.controller=new TController(e.preview.html),e.events(),e.register_listeners(),e.body_el.trigger("skytake_editor_loaded")})})},TEditor.prototype.onChange=function(e,t){var i={name:e,el:jQuery('.dlb_input .__input[name="'+e+'"]'),callback:t||null};i.el.is("select")?i.event="change":i.el.is('[type="radio"]')?i.event="change":i.event="input",this.listener_list[e]=i},TEditor.prototype.setValue=function(e,t){if(this.listener_list.hasOwnProperty(e)){var i=this.listener_list[e];i.el.val(t).trigger(i.event)}},TEditor.prototype.getValue=function(e){if(this.listener_list.hasOwnProperty(e))return this.listener_list[e].el.val()},TEditor.prototype.getElement=function(e){if(this.listener_list.hasOwnProperty(e))return this.listener_list[e].el},TEditor.prototype.register_listeners=function(){var e=this;Object.keys(e.listener_list).map(function(t){var i=e.listener_list[t];i.el.on(i.event,function(t){var n=jQuery(this).val();e.changed_settings[i.name]=n,e.save_el.removeAttr("disabled"),i.callback&&i.callback.call(this,t,n)})})},TEditor.prototype.events=function(){var e=this;e.save_el.on("click",function(t){t.preventDefault(),e.save_el.attr("disabled","disabled"),e.loader_el.show(),e.ajax("save_editor_settings",e.changed_settings).done(function(t){e.changed_settings={},e.loader_el.hide()})}),e.win_el.on("beforeunload",function(t){if(!skytake_exit_confirm(e.changed_settings))return!1}),e.back_el.on("click",function(t){t.preventDefault(),e.panel_el.attr("data-level","1"),e.bar_el.attr("data-level","1"),e.lvl2_el.css("display","none"),e.preview.html.trigger("skytake_editor_tab_changed","")}),e.panel_el.find(".skt__level_1 li").on("click",function(t){var i=jQuery(this),n=i.data("target");e.panel_el.attr("data-level","2"),e.bar_el.attr("data-level","2"),e.lvl2_title_el.find(".__text").text(i.data("title")),e.lvl2_el.css("display","none").filter(".__target_"+n).css("display","block"),e.preview.html.trigger("skytake_editor_tab_changed",n)})},TEditor.prototype.ajax=function(e,t){return(t="object"==typeof t?t:{}).action="skytake_"+e,t.nonce=jQuery('[name="skytake_nonce"]').val(),t.campaign_id=jQuery('[name="skytake_campaign_id"]').val(),jQuery.ajax({type:"POST",url:ajaxurl,data:t,async:!0,cache:!1})},window.teditor=new TEditor,teditor.onChange("campaign_status"),teditor.onChange("campaign_name",function(e,t){skytake_campaign_name_control(t)}),teditor.onChange("display_trigger",function(e,t){var i=jQuery(".display_after_x_seconds_container"),n=jQuery(".scrolling_down_percentage_container");"random"===t?(i.removeClass("__hidden"),n.removeClass("__hidden")):"load"===t?(i.removeClass("__hidden"),n.addClass("__hidden")):"scroll"===t?(i.addClass("__hidden"),n.removeClass("__hidden")):(i.addClass("__hidden"),n.addClass("__hidden"))}),teditor.onChange("display_after_x_seconds"),teditor.onChange("scrolling_down_percentage"),teditor.onChange("reminder_number_notsub"),teditor.onChange("reminder_type_notsub"),teditor.onChange("reminder_number_sub"),teditor.onChange("main_image",function(e,t){teditor.preview.el.attr("data-mainimage",""==t?0:1);var i=teditor.preview.el.find(".skytake-box-one");i.find("img").length||i.find("span").length?""==t?i.find("img").replaceWith("<span></span>"):i.find("span").replaceWith('<img src="'+t+'" >'):teditor.preview.el.find(".skytake-box-one").css("background-image","url("+t+")")}),teditor.onChange("title",function(e,t){teditor.preview.el.find(".skytake-view.__request .skytake-title").html(t)}),teditor.onChange("message",function(e,t){teditor.preview.el.find(".skytake-view.__request .skytake-message").html(t)}),teditor.onChange("is_input_name_enabled",function(e,t){skytake_input_name_control.call(this,t)}),teditor.onChange("is_mobile_input_enabled",function(e,t){skytake_input_mobile_control.call(this,t)}),teditor.onChange("name_input_text",function(e,t){teditor.preview.el.find(".skytake-name").val(t)}),teditor.onChange("input_mobile_text",function(e,t){teditor.preview.el.find(".skytake-mobile").val(t)}),teditor.onChange("email_input_text",function(e,t){teditor.preview.el.find(".skytake-email").val(t)}),teditor.onChange("submit_button_text",function(e,t){teditor.preview.el.find(".skytake-submit").text(t)}),teditor.onChange("spam_text",function(e,t){teditor.preview.el.find(".skytake-spam").text(t),""==t?teditor.preview.el.find(".skytake-spam").addClass("__hidden"):teditor.preview.el.find(".skytake-spam").removeClass("__hidden")}),teditor.onChange("is_gdpr_enabled",function(e,t){var i=jQuery(this);1==t?(i.closest("li").next().removeClass("__hidden"),teditor.preview.el.find(".skytake-gdpr-container ").removeClass("__hidden")):(i.closest("li").next().addClass("__hidden"),teditor.preview.el.find(".skytake-gdpr-container ").addClass("__hidden"))}),teditor.onChange("gdpr_text",function(e,t){teditor.preview.el.find(".skytake-gdpr-text").html(t)}),teditor.onChange("title_after_sub",function(e,t){teditor.preview.el.find(".skytake-view.__response .skytake-title").html(t)}),teditor.onChange("message_after_sub",function(e,t){teditor.preview.el.find(".skytake-view.__response .skytake-message").html(t)}),teditor.onChange("template",function(e,t){skytake_change_template(t)}),teditor.onChange("animation",function(e,t){teditor.preview.el.attr("data-animation",t).removeClass("__show"),setTimeout(function(){teditor.preview.el.addClass("__show")},400)}),teditor.onChange("overlay_color",function(e,t){teditor.preview.html.find(".skytake-overlay").css("background-color",t)}),teditor.onChange("layout",function(e,t){teditor.preview.el.attr("data-layout",t),"right"===t?teditor.setValue("body_bg_position","left center"):"left"===t?teditor.setValue("body_bg_position","right center"):teditor.setValue("body_bg_position","center center")}),teditor.onChange("body_bg_color",function(e,t){teditor.preview.el.find(".skytake-container").css("background-color",t)}),teditor.onChange("body_bg_image",function(e,t){skytake_bg_image_control(t)}),teditor.onChange("body_bg_repeat",function(e,t){teditor.preview.el.find(".skytake-container").css("background-repeat",t)}),teditor.onChange("body_bg_size",function(e,t){teditor.preview.el.find(".skytake-container").css("background-size",t)}),teditor.onChange("body_bg_position",function(e,t){teditor.preview.el.find(".skytake-container").css("background-position",t)}),teditor.onChange("font_family",function(e,t){skytake_change_font(t)}),teditor.onChange("title_color",function(e,t){teditor.preview.el.find(".skytake-title").css("color",t)}),teditor.onChange("title_font_size",function(e,t){teditor.preview.el.find(".skytake-title").css("font-size",t+"px")}),teditor.onChange("body_color",function(e,t){teditor.preview.el.find(".skytake-view, .skytake-view a").css("color",t)}),teditor.onChange("body_font_size",function(e,t){teditor.preview.el.find(".skytake-view").css("font-size",t+"px")}),teditor.onChange("email_color",function(e,t){teditor.preview.el.find(".skytake-email, .skytake-name, .skytake-mobile").css("color",t)}),teditor.onChange("email_bg_color",function(e,t){teditor.preview.el.find(".skytake-email, .skytake-name, .skytake-mobile").css("background-color",t)}),teditor.onChange("input_font_size",function(e,t){teditor.preview.el.find(".skytake-email, .skytake-name, .skytake-mobile, .skytake-submit").css("font-size",t+"px")}),teditor.onChange("submit_color",function(e,t){teditor.preview.el.find(".skytake-submit").css("color",t)}),teditor.onChange("submit_bg_color",function(e,t){teditor.preview.el.find(".skytake-submit").css("background-color",t)}),teditor.onChange("close_icon_color",function(e,t){teditor.preview.el.find(".skytake-close").css("fill",t)}),teditor.onChange("close_icon_bg_color",function(e,t){teditor.preview.el.find(".skytake-close").css("background-color",t)}),teditor.onChange("is_welcome_email_enabled"),teditor.onChange("welcome_email_subject"),teditor.onChange("welcome_email_content"),teditor.onChange("is_loggedin_enabled"),teditor.onChange("is_administrators_enabled"),teditor.onChange("filter_hide_on_articles"),teditor.onChange("filter_type"),teditor.onChange("filter_pages_excluded"),teditor.onChange("is_coupon_enabled"),teditor.onChange("selected_coupon"),teditor.onChange("is_mailchimp_enabled"),teditor.onChange("mailchimp_listid"),teditor.onChange("is_mailchimp_campaign_enabled"),teditor.onChange("mailchimp_campaign_url"),teditor.onChange("mailchimp_apikey",function(e){skytake_set_mailchimp_lists()}),teditor.body_el.on("skytake_editor_loaded",function(e){skytake_set_mailchimp_lists()}),teditor.onChange("display_minimized_bar"),teditor.onChange("minimized_bar_position",function(e,t){teditor.preview.bar.attr("data-position",t)}),teditor.onChange("minimized_bar_icon",function(e,t){teditor.preview.bar.find("span").attr("class",t)}),teditor.onChange("minimized_bar_size",function(e,t){teditor.preview.bar.find("span").css({"font-size":t+"px","line-height":t+"px"})}),teditor.onChange("minimized_bar_color",function(e,t){teditor.preview.bar.find("span").css("color",t)}),teditor.onChange("minimized_bar_bg_color",function(e,t){teditor.preview.bar.css("background-color",t)}),teditor.onChange("urgency_type",function(e,t){teditor.preview.el.find(".skytake-urgency").attr("data-type",t);var i=jQuery(".skytake_urgency_session_container"),n=jQuery(".skytake_urgency_session_recreate_container"),a=jQuery(".urgency_expire_date_container"),o=jQuery(".urgency_usage_limit_container");"disabled"===t?(i.addClass("__hidden"),n.addClass("__hidden"),a.addClass("__hidden"),o.addClass("__hidden")):"session"===t?(i.removeClass("__hidden"),n.removeClass("__hidden"),a.addClass("__hidden"),o.addClass("__hidden")):"expiry_date"===t?(i.addClass("__hidden"),n.addClass("__hidden"),a.removeClass("__hidden"),o.addClass("__hidden")):"usage_limit"===t&&(i.addClass("__hidden"),n.addClass("__hidden"),a.addClass("__hidden"),o.removeClass("__hidden"))}),teditor.onChange("urgency_session_time"),teditor.onChange("urgency_session_type"),teditor.onChange("skytake_urgency_session_recreate"),teditor.onChange("urgency_expire_date"),teditor.onChange("urgency_usage_limit"),teditor.onChange("urgency_font_size",function(e,t){teditor.preview.el.find(".skytake-urgency").css("font-size",t+"px")}),teditor.onChange("urgency_color",function(e,t){teditor.preview.el.find(".skytake-urgency-usage-limit > div, .skytake-urgency-timer > div").css("color",t)}),teditor.onChange("urgency_bg_color",function(e,t){teditor.preview.el.find(".skytake-urgency-usage-limit > div, .skytake-urgency-timer > div").css("background-color",t)}),teditor.onChange("social_open_link_new_tab"),teditor.onChange("social_icon_icon",function(e,t){teditor.preview.el.find(".skytake-social-icons a").each(function(){var e=jQuery(this).find("span");e.attr("class",e.data("icon")+t.replace("dlbicons-facebook",""))})}),teditor.onChange("social_icon_size",function(e,t){teditor.preview.el.find(".skytake-social-icons span").css("font-size",t+"px")}),teditor.onChange("social_color_type",function(e,t){"default"===t?teditor.preview.el.find(".skytake-social-icons").removeClass("__color_type_custom").addClass("__color_type_default"):teditor.preview.el.find(".skytake-social-icons").removeClass("__color_type_default").addClass("__color_type_custom")}),teditor.onChange("social_icon_color",function(e,t){teditor.preview.el.find(".skytake-social-icons.__color_type_custom span").css("color",t)}),teditor.onChange("social_icon_facebook",function(e,t){var i=teditor.preview.el.find(".skytake-social-icons");""===t?(i.attr("data-count",parseInt(i.attr("data-count"))-1),teditor.preview.el.find(".skytake-social-icon-facebook").addClass("__hidden")):(i.attr("data-count",parseInt(i.attr("data-count"))+1),teditor.preview.el.find(".skytake-social-icon-facebook").removeClass("__hidden"))}),teditor.onChange("social_icon_twitter",function(e,t){var i=teditor.preview.el.find(".skytake-social-icons");""===t?(i.attr("data-count",parseInt(i.attr("data-count"))-1),teditor.preview.el.find(".skytake-social-icon-twitter").addClass("__hidden")):(i.attr("data-count",parseInt(i.attr("data-count"))+1),teditor.preview.el.find(".skytake-social-icon-twitter").removeClass("__hidden"))}),teditor.onChange("social_icon_instagram",function(e,t){var i=teditor.preview.el.find(".skytake-social-icons");""===t?(i.attr("data-count",parseInt(i.attr("data-count"))-1),teditor.preview.el.find(".skytake-social-icon-instagram").addClass("__hidden")):(i.attr("data-count",parseInt(i.attr("data-count"))+1),teditor.preview.el.find(".skytake-social-icon-instagram").removeClass("__hidden"))}),teditor.onChange("social_icon_pinterest",function(e,t){var i=teditor.preview.el.find(".skytake-social-icons");""===t?(i.attr("data-count",parseInt(i.attr("data-count"))-1),teditor.preview.el.find(".skytake-social-icon-pinterest").addClass("__hidden")):(i.attr("data-count",parseInt(i.attr("data-count"))+1),teditor.preview.el.find(".skytake-social-icon-pinterest").removeClass("__hidden"))}),teditor.onChange("social_icon_linkedin",function(e,t){var i=teditor.preview.el.find(".skytake-social-icons");""===t?(i.attr("data-count",parseInt(i.attr("data-count"))-1),teditor.preview.el.find(".skytake-social-icon-linkedin").addClass("__hidden")):(i.attr("data-count",parseInt(i.attr("data-count"))+1),teditor.preview.el.find(".skytake-social-icon-linkedin").removeClass("__hidden"))}),teditor.onChange("social_icon_youtube",function(e,t){var i=teditor.preview.el.find(".skytake-social-icons");""===t?(i.attr("data-count",parseInt(i.attr("data-count"))-1),teditor.preview.el.find(".skytake-social-icon-youtube").addClass("__hidden")):(i.attr("data-count",parseInt(i.attr("data-count"))+1),teditor.preview.el.find(".skytake-social-icon-youtube").removeClass("__hidden"))});